var summary=function(rdd,its){var tokens=rdd.tokens,sentences=rdd.sentences,cache=rdd.cache,numOfSentences=rdd.sentences.length,aptTokens=[],aptPOS=["ADJ","ADV","NOUN","PROPN","VERB"],weights=[],numOfConvergence=0,colSum=[];console.log(`Number of sentences in text:${numOfSentences}`);for(let i=0;i<numOfSentences;i+=1){const temp=[];for(let j=sentences[i][0];j<=sentences[i][1];j+=1)"word"===its.type(j,tokens,cache)&&!its.stopWordFlag(j,tokens,cache)&&aptPOS.includes(its.pos(j,tokens,cache))&&temp.push(its.normal(j,tokens,cache));aptTokens.push(temp)}console.log(`Number of sentences in aptTokens:${aptTokens.length}`),console.log("aptTokens:"),console.log(aptTokens);var senGraph=new Array(numOfSentences);for(let i=0;i<numOfSentences;i+=1)senGraph[i]=new Array(numOfSentences);for(let i=0;i<numOfSentences-1;i+=1){senGraph[i][i]=0;for(let j=i+1;j<numOfSentences;j+=1){const numOfCommonTokens=aptTokens[i].filter((token=>aptTokens[j].includes(token))).length;senGraph[i][j]=numOfCommonTokens/(Math.log(aptTokens[i].length)+Math.log(aptTokens[j].length)),senGraph[j][i]=senGraph[i][j]}}console.log("SenGraph:"),console.log(senGraph);for(let i=0;i<numOfSentences;i+=1)colSum[i]=senGraph[i].reduce(((previousValue,currentValue)=>previousValue+currentValue),0);for(let i=0;i<numOfSentences;i+=1)weights.push({idx:i,val:1/numOfSentences});console.log("Intital Weights:"),console.log(weights);for(let i=0;i<100;i+=1){for(let j=0;j<numOfSentences;j+=1){let rank=1-.85;rank+=.85*senGraph[j].reduce(((previousValue,currentValue,idx)=>previousValue+currentValue/colSum[idx]*weights[idx].val),0),Math.abs(weights[j]-rank)<=1e-4&&(numOfConvergence+=1),weights[j].val=rank}if(numOfConvergence===numOfSentences)break}return weights.sort(((a,b)=>b.val-a.val)),console.log("Final Weights:"),console.log(weights),weights};module.exports=summary;